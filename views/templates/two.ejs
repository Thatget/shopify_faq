<div class="root-faq-template" style="margin:1.8em auto;max-width:1400px;">
    <div class="faq-header" style="text-align: center;">
        <% if(setting.data.page_title_content) { %>
            <h2><%- setting.data.page_title_content %></h2>
        <% } %>
        <div style="text-align: center;margin: 9px; padding: 2rem;">
            <input style="width: 80%;padding: 1rem 0.75rem;" id="search-text" onkeyup="simpleSearch()" type="text" <% if(setting.data.search_placehoder) {%> placeholder="<%= setting.data.search_placehoder %>" <%}%> name="search">
        </div>
    <% if(setting.data.show_intro_text) {%>
        <% if(setting.data.intro_text_content) {%>
            <p><%- setting.data.intro_text_content %></p>
        <% } %>
    <% } %>
    </div>
    <% if(faqs.length){ %>
        <div style="margin-bottom: 12px;">
            <% var faq_category = [] %>
            <% var faq_category_count = 0 %>
            <% for(var i=0; i < faqs.length; i++) { %>
                <% let faq_category_content = {} %>
                <% if(!faq_category.length){%>
                    <% faq_category_content.title = faqs[i].category_title %>
                    <% faq_category_content.faqs = [{title:faqs[i].title,content:faqs[i].content}] %>
                    <% faq_category[faq_category_count] = faq_category_content %>
                <% } else { %>
                    <% let checkExites = false %>
                    <% for(var j=0; j < faq_category.length; j++) { %>
                        <% if(faq_category[j].title === faqs[i].category_title){%>
                            <% faq_category[j].faqs.push({title:faqs[i].title,content:faqs[i].title})%>
                            <% checkExites = true %>
                        <% } %>
                    <% } %>
                    <% if(!checkExites){%>
                        <% faq_category_count++ %>
                        <% faq_category_content.title = faqs[i].category_title %>
                        <% faq_category_content.faqs = [{title:faqs[i].title,content:faqs[i].content}] %>
                        <% faq_category[faq_category_count] = faq_category_content %>
                    <% } %>
                <% } %>
            <% } %>
            <% if(faq_category.length){%>
                <% for(var i=0; i < faq_category.length; i++) { %>
                    <div class="category-faq-container" style="margin-bottom: 12px;">
                        <h2 class="faq-category-title"><%- faq_category[i].title %></h2>
                        <% for(var j=0; j < faq_category[i].faqs.length; j++) { %>
                            <div class="faq-main-content" style="margin-bottom: 12px;">
                                <div class="faq-question-title" style="width: 100%;font-weight: bold;cursor: pointer; padding: 1em;" onclick="showHideContent(this)">
                                    <span class="listed-faq"><%= faq_category[i].faqs[j].title %></span>
                                </div>
                                <div class="faq-answer-content" style="display: none;margin:0;padding:1em 1em 1em 1em;line-height:1.5;">
                                    <%- faq_category[i].faqs[j].content %>
                                </div>
                            </div>
                        <%}%>
                    </div>
                <% } %>
            <% } %>
            <div id="not-found-text" style="display: none" >
                <% if(setting.data.search_not_found) {%>
                    <%- setting.data.search_not_found %>
                <% } %>
            </div>
        </div>
    <% } %>
    <div>
        <% if(setting.data.show_footer_text) {%>
            <% if(setting.data.footer_text_content) {%>
                <%- setting.data.footer_text_content %>
            <% } %>
        <% } %>
    </div>
</div>
<script>
    function showHideContent(el) {
        var content = el.nextElementSibling;
        if (content.style.display === "block") {
            content.style.display = "none";
        } else {
            content.style.display = "block";
        }
    }

    function simpleSearch() {
        var input = document.getElementById("search-text");
        var filter = input.value.toLowerCase();
        var nodes = document.getElementsByClassName('listed-faq');
        var nodeCategory = document.getElementsByClassName('category-faq-container');

        var checkexist = true;
        for (i = 0; i < nodes.length; i++) {
            if (nodes[i].innerText.toLowerCase().includes(filter)) {
                nodes[i].parentNode.parentNode.style.display = "block";
                checkexist = false;
            } else {
                nodes[i].parentNode.parentNode.style.display = "none";
            }
        }
        for (j = 0; j < nodeCategory.length; j++) {
            let subFaq = nodeCategory[j].getElementsByClassName('faq-main-content');
            let checkDisplay = false;
            for (k = 0; k < subFaq.length; k++) {
                if(subFaq[k].style.display == "block") {
                    checkDisplay = true;
                    break;
                }
            }
            if (checkDisplay) {
                nodeCategory[j].style.display = "block";
            } else nodeCategory[j].style.display = "none";
        }
        if (checkexist) {
            document.getElementById("not-found-text").style.display = "block";
        } else {
            document.getElementById("not-found-text").style.display = "none";
        }
    }

</script>
<style>
    <% if(setting.templateSetting.width_faqs_accordian) { %>
    .root-faq-template {
        width: <%- setting.templateSetting.width_faqs_accordian%>px;
    }
    <% } if(setting.templateSetting.image_banner) { %>
    .faq-header {
        background-image: url('<%- setting.templateSetting.image_banner%>');
        background-repeat: no-repeat;
        background-size: cover;
    }
    <%} if(setting.templateSetting.custom_css) { %>
    <%- setting.templateSetting.custom_css%>
    <%}%>
</style>