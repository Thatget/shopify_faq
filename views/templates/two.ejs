<div class="root-faq-template">
    <div class="faq-header" style="text-align: center;max-width: 100vw; display: flex; flex-direction: column; justify-content: space-between;">
        <div>
            <% if(setting.data.page_title_content && setting.data.show_page_title) { %>
                <h1 style="color: #fff;margin:0; padding: 20px 0; font-weight: 600;"><%- setting.data.page_title_content %></h1>
            <% } %>
            <% if(setting.data.show_page_title && setting.data.page_title_content){%>
                <div style="text-align: center; padding: 2rem;">
                    <input class="search-input" style="" id="search-text" onkeyup="simpleSearch()" type="text" <% if(setting.data.search_placehoder) {%> placeholder="<%= setting.data.search_placehoder %>" <%}%> name="search">
                </div>
            <%}
            else{%>
                <div style="text-align: center; padding: 2rem; margin-top: 70px;">
                    <input style="width: 60%; padding: 1rem; border-radius: 4px; outline: none; border: none; font-size: 1.6rem;" id="search-text" onkeyup="simpleSearch()" type="text" <% if(setting.data.search_placehoder) {%> placeholder="<%= setting.data.search_placehoder %>" <%}%> name="search">
                </div>
            <%} %>
        </div>
        <div>
            <% if(setting.data.show_intro_text && setting.data.intro_text_content) {%>
                <div style="text-align: center; padding: 10px 0; color: #fff;">
                    <span style="font-size: 18px;"><%- setting.data.intro_text_content %></span>
                </div>
            <% } %>    
        </div>
    </div>
    <div class="faq-main">
        <% if(faqs.length && !setting.data.dont_category_faq){ %>
            <div style="margin: 30px 0">
                <div class="">
                    <% var faq_category = [] %>
                    <% var faq_category_count = 0 %>
                    <% for(var i=0; i < faqs.length; i++) { %>
                        <% let faq_category_content = {} %>
                        <% 
                        if(!faq_category.length){%>
                            <% faq_category_content.title = faqs[i].category_title %>
                            <% faq_category_content.faqs = [{title:faqs[i].title,content:faqs[i].content}] %>
                            <% faq_category[faq_category_count] = faq_category_content %>
                        <% } 
                        else { %>
                            <% let checkExites = false %>
                            <% for(var j=0; j < faq_category.length; j++) { %>
                                <% if(faq_category[j].title === faqs[i].category_title){%>
                                    <% faq_category[j].faqs.push({title:faqs[i].title,content:faqs[i].title})%>
                                    <% checkExites = true %>
                                <% } %>
                            <% } %>
                            <% if(!checkExites){%>
                                <% faq_category_count++ %>
                                <% faq_category_content.title = faqs[i].category_title %>
                                <% faq_category_content.faqs = [{title:faqs[i].title,content:faqs[i].content}] %>
                                <% faq_category[faq_category_count] = faq_category_content %>
                            <% } %>
                        <% } %>
                    <% } %>
                    <% if(faq_category.length){%>
                        <div class="category-bar" style="display: flex; justify-content: center; flex-wrap: wrap; margin-bottom: 20px;">
                            <% for(var i=0; i < faq_category.length; i++) { %>
								<a href="#<%- faq_category[i].title %>" class="faq-category-title" style="padding: 4px 8px; margin:6px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; text-decoration: none; font-size: 16px !important;"><%- faq_category[i].title %></a>
                            <% } %>
                        </div>
                        <div style="margin-top: 20px">
                            <% for(var i=0; i < faq_category.length; i++) { %>
                                <div class="category-faq-container" style="margin-bottom: 20px;">
                                    <div id="<%- faq_category[i].title %>" class="faq-category-title" style="width: 100%;"><%- faq_category[i].title %></div>
                                    <% for(var j=0; j < faq_category[i].faqs.length; j++) { %>
                                        <div class="faq-main-content" style="margin-bottom: 12px;">
                                            <div class="faq-question-title" style="display: flex; align-items: center; width: 100%;cursor: pointer; padding: 12px;font-size: <%=  setting.templateSetting.faq_font_size %>px; border-radius: 4px 4px 0 0;" onclick="showHideContent(this)">
                                                <span class="listed-faq" style="width: 100%; user-select: none;"><%= faq_category[i].faqs[j].title %></span>
                                                <svg class="svg-right" style="width: 20px; height: 20px" fill="<%= setting.templateSetting.faq_font_color %>" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg>
                                                <svg class="svg-down" style="display:none; width: 20px; height: 20px" fill="<%= setting.templateSetting.faq_font_color %>" viewBox="0 0 320 512"><!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --><path d="M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"/></svg>
                                            </div>
                                            <div class="faq-answer-content" style="display: none; margin:0; padding: 12px; border-radius: 0 0 4px 4px; border:1px solid #ccc;">
                                                <%- faq_category[i].faqs[j].content %>
                                            </div>
                                        </div>
                                    <%}%>
                                </div>
                            <% } %>
                        </div>
                    <% } %>
                    <div id="not-found-text" style="display: none; text-align: center; font-size: 3rem;" >
                        <% if(setting.data.search_not_found) {%>
                            <%- setting.data.search_not_found %>
                        <% } %>
                    </div>
                </div>
            </div>
        <% }
        else{ %>
            <div style="margin: 30px 0;">
                <% for(var j=0; j < faqs.length; j++) { %>
                    <div class="faq-main-content" style="margin-bottom: 12px;">
                        <div class="faq-question-title" style="display: flex; align-items: center; width: 100%;cursor: pointer; padding: 12px;font-size: <%=  setting.templateSetting.faq_font_size %>px; border-radius: 4px 4px 0 0" onclick="showHideContent(this)">
                            <span class="listed-faq" style="width: 100%;"><%= faqs[j].title %></span>
                            <svg class="svg-right" style="width: 20px; height: 20px" fill="<%= setting.templateSetting.faq_font_color %>" viewBox="0 0 256 512"><!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg>
                            <svg class="svg-down" style="display: none; width: 20px; height: 20px" fill="<%= setting.templateSetting.faq_font_color %>" viewBox="0 0 320 512"><!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --><path d="M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"/></svg>
                        </div>
                        <div class="faq-answer-content" style="display: none; margin:0; padding: 12px; border-radius: 0 0 4px 4px;">
                            <%- faqs[j].content %>
                        </div>
                    </div>
                <%}%>
            </div>
        <% } %>
        <% if(setting.data.show_footer_text) {%>
            <div style="text-align: center; padding: 10px 0; font-size: 18px">
                <% if(setting.data.footer_text_content) {%>
                    <%- setting.data.footer_text_content %>
                <% } %>
            </div>
        <% } %>
    </div>
</div>
<script>
    function showHideContent(el) {
        var content = el.nextElementSibling;
        var svgRight = el.getElementsByClassName('svg-right')
        var svgDown = el.getElementsByClassName('svg-down')
        if (content.style.display === "block") {
            content.style.display = "none";
        } else {
            content.style.display = "block";
        }
        if (svgRight[0].style.display === "none") {
            svgRight[0].style.display = "block";
        } else {
            svgRight[0].style.display = "none";
        }
        if (svgDown[0].style.display === "block") {
            svgDown[0].style.display = "none";
        } else {
            svgDown[0].style.display = "block";
        }
    }
    function simpleSearch() {
        var input = document.getElementById("search-text");
        var filter = input.value.toLowerCase();
        var nodes = document.getElementsByClassName('listed-faq');
        var nodeCategory = document.getElementsByClassName('category-faq-container');
        if(document.getElementById('search-text').value === ''){
            document.getElementsByClassName('category-bar')[0].style.display = "flex"
        }
        else{
            document.getElementsByClassName('category-bar')[0].style.display = "none"
        }
        var checkexist = true;
        for (i = 0; i < nodes.length; i++) {
            if (nodes[i].innerText.toLowerCase().includes(filter)) {
                nodes[i].parentNode.parentNode.style.display = "block";
                checkexist = false;
            } else {
                nodes[i].parentNode.parentNode.style.display = "none";
            }
        }
        for (j = 0; j < nodeCategory.length; j++) {
            let subFaq = nodeCategory[j].getElementsByClassName('faq-main-content');
            let checkDisplay = false;
            for (k = 0; k < subFaq.length; k++) {
                if(subFaq[k].style.display == "block") {
                    checkDisplay = true;
                    break;
                }
            }
            if (checkDisplay) {
                nodeCategory[j].style.display = "block";
            } else nodeCategory[j].style.display = "none";
        }
        if (checkexist) {
            document.getElementById("not-found-text").style.display = "block";
        } else {
            document.getElementById("not-found-text").style.display = "none";
        }
    }

</script>
<style>
    <% if(setting.templateSetting.width_faqs_accordian) { %>
    .faq-main {
        padding: 0 20px;
        max-width: <%- setting.templateSetting.width_faqs_accordian%>px;
        margin: auto;
    }
    <% } if(setting.templateSetting.image_banner) { %>
    .faq-header {
        min-height: <%- setting.templateSetting.banner_height%>px;
        max-width: 100vw;
        background-image: url('<%- setting.templateSetting.image_banner%>');
        background-repeat: no-repeat;
        background-size: cover;
        background-position-y: center;
        transition
    }
    <%} if(setting.templateSetting.custom_css) { %>
    <%- setting.templateSetting.custom_css%>
    <%= setting.templateSetting.custom_css%>
    <%}
    %>
    .search-input{
        width: 60%; 
        padding: 1rem; 
        border-radius: 4px; 
        outline: none; 
        border: none; 
        font-size: 1.6rem;
    }
    @media only screen and (max-width: 700px) {
        .search-input {
            width: 95%;
        }
    }
</style>